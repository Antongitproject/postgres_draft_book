## **Настройка планировщика ввода-вывода операционной системы**

|Вариант использования                                                           |Планировщик дисков                                                                                                                            |
|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------|
|Традиционный жесткий диск с интерфейсом SCSI                                    |Рекомендуется mq-deadline или bfq                                                                                                             |
|Высокопроизводительный SSD или система с привязкой к ЦП с быстрым хранилищем    |Рекомендуется none, особенно при запуске корпоративных приложений. В качестве альтернативы можно использовать kyber                           |
|Настольные системы или интерактивные задачи                                     |Рекомендуется bfq                                                                                                                             |
|Виртуальные гостевые системы                                                    |Рекомендуется mq-deadline. С адаптером главной шины (HBA), поддерживающим работу с несколькими очередями, рекомендуется использовать noop/none|


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проверить scheduler для диска, где будет храниться СУБД PostgreSQL/PRO, использоваться должен "mq-deadline"
    ```bash 
    cat /sys/block/<sdb>/queue/scheduler
    ```

!!! info "Пример вывода команды cat"
    mq-deadline kyber bfq [none]     
    _Используемый планировщик выделен квадратными скобками._

!!! attention "Внимание!"
    Если меняется scheduler, то требуется выполнить перезапуск сервера

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Изменение планировщика ввода-вывода     

!!! info "Изменить используемый планировщик без необходимости перезагрузки можно командой:"
    ```bash
    echo none > /sys/block/sdX/queue/scheduler
    ```
    _где X — буква физического накопителя._    
    _Данная настройка действует только до первой перезагрузки ОС._

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Для постоянной настройки необходимо создать правило UDEV.
    ```bash
    cat << EOF > /etc/udev/rules.d/60-schedulerset.rules      
    ACTION=="add|change", SUBSYSTEM=="block", KERNEL=="sd[a-z]", ATTR{queue/rotational}="1", ATTR{queue/scheduler}="none"      
    EOF    
    ```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Применить правила
    ```bash
    udevadm control --reload-rules && udevadm trigger --type=devices --action=change
    ```

